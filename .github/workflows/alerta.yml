name: CI - Alerta DevOps ITLA

on:
  push:
    branches:
      - main

jobs:
  build-and-notify:
    runs-on: ubuntu-latest
    steps:
      - name: üì¶ Checkout del repositorio
        uses: actions/checkout@v3

      - name: üß† Configurar Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'

      - name: üöÄ Ejecutar programa Hola Mundo
        run: |
          echo "console.log('Hola Mundo - Integraci√≥n Continua funcionando correctamente');" > app.js
          node app.js

      - name: ‚úÖ Notificar a ntfy.sh (Build Completado con √âxito)
        if: success()
        run: |
          curl -H "Title: Build Completado con √âxito" \
               -H "Tags: success" \
               -d $'El programa Hola Mundo se ejecut√≥ correctamente y todos los tests pasaron.\n\nIntegraci√≥n Continua funcionando perfectamente!' \
               https://ntfy.sh/devops-itla

      - name: ‚ùå Notificar a ntfy.sh (Build Fallido)
        if: failure()
        run: |
          curl -H "Title: Build Fallido" \
               -H "Tags: error" \
               -d $'El build de la integraci√≥n continua ha fallado.\n\nRevisa los logs en GitHub Actions para m√°s detalles.' \
               https://ntfy.sh/devops-itla


